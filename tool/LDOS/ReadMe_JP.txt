%================================================================
% ELSES version 0.0.0
% Copyright (C) ELSES. 2007 all rights reserved
%================================================================

Local Density of State (LDOS) の計算の仕方

(I)用意するもの:
		Hamiltonian.txt		ELSES パッケージ中の elses 実行中に生成される。
		input.txt			エディタなどで各自用意する。書式は後述。
		実行バイナリ			後述する手順に従って ELSES パッケージの最上位ディレクトリの下の
							bin ディレクトリに作られる。

(II)出力されるもの:
		LDOS_diag.dat		カラムの内容は左から順に エネルギー($\omega$)、LDOS $=-\frac{1}{\pi}Im(G_{ii}(\omega))$、
							台形則で積分した積分LDOSの誤差、解析的に計算した積分LDOS。
		TDOS_diag.dat		LDOS_diag.dat の LDOS を全状態密度(Total Density of State)にしたもの。
		Green_diag.dat		第1カラムは LDOS_diag.dat, TDOS_diag.dat と同じ。第2、第3カラムはそれぞれ,
							$G_{ii}(\omega)$ の実部と虚部。
		EIGN_diag.dat		Hamiltonian の全固有値。

(III)実行バイナリの生成法
		ELSES パッケージの build 中に最上位ディレクトリの下の bin というディレクトリに自動的に生成される。
		LDOS 計算部分だけ生成するには、最上位ディレクトリから tool/LDOS/src に cd し、make -f Makefile-elses を実行する。


(IV)input.txt の書式			ELSES 原著作者の一人、高山博士が決めた入力書式に従っている。
							(http://act.jst.go.jp/content/h13/material/M04/PageMain.html 参照)
							以下にサンプルを示し、その後に説明を加える。サンプルはソースと同じディレクトリにある。


-------From here <input.txt>------
-16.0d0, -16.0d0, 177,    eps_ref,eps_shift,nitemax,
 0,-0.14d0,               iswEscale,Esample,
-50d0, 50d0, 1001,   enmin,enmax,nenemax,
 1, 1.00d+2, 2.0d0,       iswgamma,gamma,gammaXmesh,
   1,   1,   1,           target_i,target_j,target_k,
-------To here <input.txt>------
以下、各項目の説明
eps_ref	  : 互換性のための項目 Green_diag では不使用
eps_shift : 互換性のための項目 Green_diag では不使用
nitemax	  : 互換性のための項目 Green_diag では不使用
iswEscale : 互換性のための項目 Green_diag では不使用 (互換性のために 0 を入力)
Esample	  : 互換性のための項目 Green_diag では不使用
enmin	  : LDOS などを計算するメッシュ点の下限
enmax	  : LDOS などを計算するメッシュ点の上限
nenemax	  : LDOS などを計算するメッシュ点の数。従ってメッシュ間隔 denergy=(enmax-enmin)/(nenemax-1)
iswgamma,gamma,gammaXmesh  : 有限系の状態密度はデルタ関数の集合になる。そのデルタ関数を鈍らせるために
		  入れる、エネルギーの虚部を決めるパラメータ。
		  iswgamma=0  エネルギーの虚部=gamma
		  iswgamma=1, エネルギーの虚部=denergy*gammaXmesh
target_i : Hamiltonian 行列を与える基底のうち、target_i 番目のものに対応する LDOS を計算する。
		 （注意） 特殊な機能として, target_i=0 を入力として与えると、random な状態ベクトル |v> に
		 対して <v|G(\omega)|v> を計算する。系が充分に大きい場合、これは全状態密度を推定するのに使える。
target_j,target_k : (予約されたパラメータ) 現バージョンでは不使用。

* 2008 8月4日 更新
より便利に使えるように、Hamiltonian.txt と input.txt の書式を拡張し、
LDOS を計算する軌道を、各イオンサイトの番号と、原子軌道の組み合わせで
指定できるように変更した。（拡張モード）
拡張モードは、target_i を負に設定することで利用可能になる。
次に、サンプルの input.txt をあげる。

-------From here, new way to specify the orbital in <input.txt>------
-16.0d0, -16.0d0,   500,   eps_ref,   eps_shift, nitemax
      0, -0.14d0,          iswEscale, Esample
  -50d0,    50d0,  1001,   enmin,     enmax,     nenemax
      0, 1.00d+0, 2.0d0,   iswgamma,  gamma,     gammaXmesh
     -1,       1,     1,   target_i,  target_j,  target_k
      4,                   Number of orbitals (for extended mode only)
      1,       1           (atom, atomic-orbital) pair 1
      1,       2           (atom, atomic-orbital) pair 2
      1,       3           (atom, atomic-orbital) pair 3
      1,       4           (atom, atomic-orbital) pair 4
-------To here, new way to specify the orbital in <input.txt>------

この入力を用いると、イオンサイト 1 の 原子軌道 1, 2, 3, 4 の LDOS が
逐次 LDOS.dat に書き出される。各 LDOS の出力の最後には、空行が挿入されている。


(V)実行結果のサンプル
		Hamiltonian.txt は ELSES サンプルディレクトリの C60s を実行して得たもの。
		input.txt は (IV) のサンプル。

まず、標準出力のサンプルを示す。
----From here <sample output on screen>----
 #### gamma is replaced by denergy*gammaXmesh ####
 gamma=  0.200000000000000     
,A eps_ref,eps_shift,nitemax=   0.100000E-15  0.100000E-15  177
iswEscale,Esample=             0 -0.140000    
enmin,enmax,nenemax=         -50.0000       50.0000     1001
iswgamma,gamma,gammaXmesh=     1  0.200000       2.00000    
target_i,target_j,target_k=    1    1    1
DIM=     480
# of non-zero elements=     19328
check_hamiltonian:
   Dim   =                             480
   Nelem =                           19328
   # of Ham%id1(i) > Ham%id2(i)=      9424
   (Ham%Nelem-Ham%dim)/2       =      9424
 set_NPROC: NPROC=           8
   symmetric=T
----To here   <sample output on screen>----

gnuplot にて plot 'LDOS_diag.dat' w l を実行した結果を LDOS_sample.pdf として
添付する。また、'EIGEN_diag.dat' を次に示す。

----From here <sample output of EIGN_diag.dat>----
 -2.2215659727059E+01
 -2.1850880519131E+01
 -2.1438408298126E+01
 -2.1256057716011E+01
 -2.1102536577522E+01
 -2.0947525314940E+01
 -2.0810716537237E+01
 -2.0481138523259E+01
 -2.0146722955150E+01
 -1.9791635777032E+01
 -1.9722938727519E+01
 -1.9692907285761E+01
 -1.9433546659027E+01
 -1.9280886913009E+01
 -1.9182567998199E+01
 -1.9076775535822E+01
 -1.8899052330988E+01
 -1.8583188892624E+01
 -1.8066363450905E+01
 -1.7954542649314E+01
 -1.7792187771550E+01
 -1.7748474425575E+01
 -1.7608585093857E+01
 -1.7565363376589E+01
 -1.7219484942805E+01
 -1.7128929416851E+01
 -1.6889926531839E+01
 -1.6855777827044E+01
 -1.6671282579452E+01
 -1.6436802721556E+01
 -1.6302543470777E+01
 -1.5973699909588E+01
 -1.5953933250677E+01
 -1.5613177232954E+01
 -1.5487014722586E+01
 -1.5363492586800E+01
 -1.5269658989375E+01
 -1.5039329141872E+01
 -1.5011820977927E+01
 -1.4992522984351E+01
 -1.4742859128023E+01
 -1.4645457512037E+01
 -1.4587743223147E+01
 -1.4494105005995E+01
 -1.4377890938556E+01
 -1.4323591065363E+01
 -1.4275744901363E+01
 -1.4068700698910E+01
 -1.3886679046554E+01
 -1.3769693403697E+01
 -1.3589868527743E+01
 -1.3507154353293E+01
 -1.3232011646652E+01
 -1.3094452206611E+01
 -1.3017982635810E+01
 -1.2965986048763E+01
 -1.2651844467749E+01
 -1.2648294261375E+01
 -1.2382418874852E+01
 -1.1931725908947E+01
 -1.1867503085387E+01
 -1.1530984691175E+01
 -1.1450127190936E+01
 -1.1342757364281E+01
 -1.1146199586666E+01
 -1.0943190223105E+01
 -1.0834524115092E+01
 -1.0667912681549E+01
 -1.0660893528709E+01
 -1.0495361882002E+01
 -1.0482088984826E+01
 -1.0300832844132E+01
 -1.0224873986493E+01
 -1.0192856160939E+01
 -1.0042299304815E+01
 -9.9722373381935E+00
 -9.9098845257034E+00
 -9.8357748058270E+00
 -9.6672813853327E+00
 -9.5843675337503E+00
 -9.5039624722657E+00
 -9.3968153006256E+00
 -9.3529992487400E+00
 -9.2544405506944E+00
 -9.1546919602911E+00
 -8.9858946154500E+00
 -8.8785418943852E+00
 -8.6708394941877E+00
 -8.5955308410713E+00
 -8.3739716730213E+00
 -8.3538707568071E+00
 -8.2918785282187E+00
 -8.1661812956947E+00
 -8.1552678271710E+00
 -8.1306012489486E+00
 -8.0072751052047E+00
 -7.8909732961389E+00
 -7.8540264691834E+00
 -7.8170239919429E+00
 -7.7998116669178E+00
 -7.6701090336752E+00
 -7.6321610973914E+00
 -7.5925221169010E+00
 -7.5446899908792E+00
 -7.3768046671151E+00
 -7.3009735765310E+00
 -7.2430697334212E+00
 -7.1405079834687E+00
 -7.0574914106859E+00
 -7.0162460352974E+00
 -6.9253767956058E+00
 -6.9038597232700E+00
 -6.8617112421456E+00
 -6.7762363912877E+00
 -6.6962885319402E+00
 -6.5945710898555E+00
 -6.5145671317158E+00
 -6.4510308380551E+00
 -6.4155620236727E+00
 -6.3366154901115E+00
 -6.3010792194053E+00
 -6.2410390157254E+00
 -6.1654293687106E+00
 -6.1113266008585E+00
 -6.0550814451299E+00
 -5.9843258228241E+00
 -5.8940138537265E+00
 -5.8574023216784E+00
 -5.7745871167059E+00
 -5.7218891501110E+00
 -5.6601963789101E+00
 -5.4815523670527E+00
 -5.4289914363289E+00
 -5.3818153419645E+00
 -5.2900862937434E+00
 -5.2487391336405E+00
 -5.1937441702368E+00
 -5.1585153589149E+00
 -5.1109393036392E+00
 -4.9901639202816E+00
 -4.8767861435185E+00
 -4.8114835910490E+00
 -4.7914983760452E+00
 -4.7349696224254E+00
 -4.5454779731245E+00
 -4.5092372518635E+00
 -4.4065360908715E+00
 -4.3607110203947E+00
 -4.2944052105408E+00
 -4.2402291788946E+00
 -4.1719785340395E+00
 -4.1392926350655E+00
 -3.9683756544792E+00
 -3.8176598174183E+00
 -3.5516148701138E+00
 -3.4650814117379E+00
 -3.4079641555693E+00
 -3.3139523340328E+00
 -3.2468529642411E+00
 -3.1723952232020E+00
 -3.1599204021585E+00
 -3.1067269871613E+00
 -2.9859411470990E+00
 -2.9327323345455E+00
 -2.9110355866066E+00
 -2.7749011271934E+00
 -2.6328083938910E+00
 -2.4756722682818E+00
 -2.3827580247073E+00
 -2.1688843970051E+00
 -2.0529608707589E+00
 -2.0183905489921E+00
 -1.9001501095439E+00
 -1.7499513248998E+00
 -1.5250157872091E+00
 -1.4911831792432E+00
 -1.3381425901412E+00
 -1.2655297834064E+00
 -1.0784322999691E+00
 -1.0087855784208E+00
 -9.1235973220563E-01
 -8.5118657613178E-01
 -7.4233869961443E-01
 -6.5558188639123E-01
 -4.7586325199303E-01
 -4.0512689024854E-01
 -3.4324351092163E-01
 -3.1106581766871E-01
 -1.7016538893710E-01
 -1.6639091297571E-01
 -1.1868749845028E-01
 -5.3014312039908E-02
  2.0934684156564E-03
  9.1067905677370E-02
  1.3138583255981E-01
  3.3182991130671E-01
  3.7480608443957E-01
  4.9065275280111E-01
  5.2322941983056E-01
  6.3974176380598E-01
  6.7526674541318E-01
  7.4554546516549E-01
  8.0286841616440E-01
  8.2858614096012E-01
  9.1336940202220E-01
  9.3794829795660E-01
  9.9960034055628E-01
  1.0982408154091E+00
  1.1568681108302E+00
  1.2210473440331E+00
  1.2575731078705E+00
  1.2759680232896E+00
  1.4667110082425E+00
  1.5216700425974E+00
  1.6050379189730E+00
  1.6370642763351E+00
  1.6685950755636E+00
  1.7060746890274E+00
  1.7172127510659E+00
  1.7552404708557E+00
  1.8108845379672E+00
  1.8584575871521E+00
  1.9237853986658E+00
  1.9386836072359E+00
  2.0067876860196E+00
  2.0339416299290E+00
  2.0905332235573E+00
  2.1083821742698E+00
  2.2197565899523E+00
  2.2918176662921E+00
  2.3311609697282E+00
  2.3453217306647E+00
  2.3932608910819E+00
  2.5019314212737E+00
  2.5651665674243E+00
  2.6333994508363E+00
  2.7164833517262E+00
  2.8597851397221E+00
  2.9439622148839E+00
  3.0533508527605E+00
  3.1329773049807E+00
  3.1663029906154E+00
  3.3710183945982E+00
  3.5551785959178E+00
  3.6689768672636E+00
  3.6763589272034E+00
  3.7807070988474E+00
  3.8219075708578E+00
  3.8902320733600E+00
  3.9255466056670E+00
  4.1168807874854E+00
  4.1828062330022E+00
  4.1980407939214E+00
  4.2904394582549E+00
  4.3469602537850E+00
  4.4039760252242E+00
  4.4840020834402E+00
  4.5484506346734E+00
  4.6630183278425E+00
  4.7045189431874E+00
  4.8477617952448E+00
  4.8963347284306E+00
  5.0146649122480E+00
  5.1562678377808E+00
  5.2476873491752E+00
  5.3053108646300E+00
  5.3177374172882E+00
  5.3379884585480E+00
  5.4109441812225E+00
  5.4423854033727E+00
  5.4878154967480E+00
  5.5697805083919E+00
  5.5907913167831E+00
  5.6260684183291E+00
  5.7246175968364E+00
  5.7614947518271E+00
  5.7733934545939E+00
  5.8670042750865E+00
  5.9656940949145E+00
  6.0005797378090E+00
  6.0713390811125E+00
  6.0985890909333E+00
  6.2001359520184E+00
  6.2314343609480E+00
  6.3116118961863E+00
  6.3306604769025E+00
  6.4090072369971E+00
  6.4356789433652E+00
  6.5161655838190E+00
  6.5712636133444E+00
  6.6822715033255E+00
  6.7563959422541E+00
  6.9080652280129E+00
  6.9120128328518E+00
  6.9477982612902E+00
  7.0307098088882E+00
  7.0813135468143E+00
  7.1233568039617E+00
  7.1497724265987E+00
  7.3009242663810E+00
  7.3165674611390E+00
  7.3614052138602E+00
  7.3907426827648E+00
  7.4677617612963E+00
  7.5047252958652E+00
  7.5549697745621E+00
  7.6469626649920E+00
  7.8304510787631E+00
  8.0005594441216E+00
  8.2396163829109E+00
  8.5289612847607E+00
  8.5600569737365E+00
  8.7394307005378E+00
  8.8140981570974E+00
  8.9728869134748E+00
  9.0115349111655E+00
  9.0601142505588E+00
  9.4991410726184E+00
  9.5556319065746E+00
  9.6638091624927E+00
  9.6714494402415E+00
  9.7400743213890E+00
  9.7781623004268E+00
  9.8121542458589E+00
  9.8549757684018E+00
  1.0093414318575E+01
  1.0154415919376E+01
  1.0204537055852E+01
  1.0317024471465E+01
  1.0338769268906E+01
  1.0415936849464E+01
  1.0502011152628E+01
  1.0547659232536E+01
  1.0629929539069E+01
  1.0674909852125E+01
  1.0767492824673E+01
  1.0804943095331E+01
  1.0874845939154E+01
  1.0896459018756E+01
  1.0957754684587E+01
  1.1013458964314E+01
  1.1044028872969E+01
  1.1121348249458E+01
  1.1155169020766E+01
  1.1237443623070E+01
  1.1263840740300E+01
  1.1269422714001E+01
  1.1316366412712E+01
  1.1362715421935E+01
  1.1413946491217E+01
  1.1471188980618E+01
  1.1520332930027E+01
  1.1592575107371E+01
  1.1661797101752E+01
  1.1704102544757E+01
  1.1800750019190E+01
  1.1813801111781E+01
  1.1874007588993E+01
  1.1942363585134E+01
  1.1964360664522E+01
  1.1977324940238E+01
  1.2037286834349E+01
  1.2165254413432E+01
  1.2228999416295E+01
  1.2240368062095E+01
  1.2334578182964E+01
  1.2367783744534E+01
  1.2416762142006E+01
  1.2459014094338E+01
  1.2497407465560E+01
  1.2545921588878E+01
  1.2560118755817E+01
  1.2589528634985E+01
  1.2639476322300E+01
  1.2666516924341E+01
  1.2709540567379E+01
  1.2754165276577E+01
  1.2814638132626E+01
  1.2921517229939E+01
  1.2925898598110E+01
  1.3014040633147E+01
  1.3042054965308E+01
  1.3146571345172E+01
  1.3169101987403E+01
  1.3177967494658E+01
  1.3230873399916E+01
  1.3281795404502E+01
  1.3304624745651E+01
  1.3369122230030E+01
  1.3398422638494E+01
  1.3434349328760E+01
  1.3451876307117E+01
  1.3497738510431E+01
  1.3561797630001E+01
  1.3591438639290E+01
  1.3617874146811E+01
  1.3643413689464E+01
  1.3685485711669E+01
  1.3688152259350E+01
  1.3721209840217E+01
  1.3792992561956E+01
  1.3821437189888E+01
  1.3842538064661E+01
  1.3881789090473E+01
  1.3919484336981E+01
  1.3969035934026E+01
  1.4004573403093E+01
  1.4040690533300E+01
  1.4079893917602E+01
  1.4104252857395E+01
  1.4160410895923E+01
  1.4181205698497E+01
  1.4246465801922E+01
  1.4268184644459E+01
  1.4294581558132E+01
  1.4337217146915E+01
  1.4394474696467E+01
  1.4416482911544E+01
  1.4446947997703E+01
  1.4491122292603E+01
  1.4533575705109E+01
  1.4623925129353E+01
  1.4678176410670E+01
  1.4713732647973E+01
  1.4745623790811E+01
  1.4756068205639E+01
  1.4790534779737E+01
  1.4837884152025E+01
  1.4865930523794E+01
  1.4874571402122E+01
  1.4915648061583E+01
  1.4970561085275E+01
  1.5007461721516E+01
  1.5024572884765E+01
  1.5047989583999E+01
  1.5057071591413E+01
  1.5076091500136E+01
  1.5125897528523E+01
  1.5161665738772E+01
  1.5181984950500E+01
  1.5224860141818E+01
  1.5243762505607E+01
  1.5292043887109E+01
  1.5323479609345E+01
  1.5355883074216E+01
  1.5367062455507E+01
  1.5437077762068E+01
  1.5453857945726E+01
  1.5499991500886E+01
  1.5518676873187E+01
  1.5542664282387E+01
  1.5576355933408E+01
  1.5596573225668E+01
  1.5654715600071E+01
  1.5698355144848E+01
  1.5727206044385E+01
  1.5745280324946E+01
  1.5820938657178E+01
  1.5864759580371E+01
  1.5926583324748E+01
  1.5935585001426E+01
  1.6006083956924E+01
  1.6034441815775E+01
  1.6085303730923E+01
  1.6140192693937E+01
  1.6163937455627E+01
  1.6232632273387E+01
  1.6262118888683E+01
  1.6303437391457E+01
  1.6351437129056E+01
  1.6647904775947E+01
  1.6675940676828E+01
  1.6752258852235E+01
  1.6824971030006E+01
  1.6825273243582E+01
  1.6906218553172E+01
  1.6919593463996E+01
  1.7015572601247E+01
  1.7601465567224E+01
  1.7771673083005E+01
----To here <sample output of EIGN_diag.dat>----
